# 医疗病例管理系统 - 开发计划

## 1. 当前进度

- 后端：✅ 已完成基础架构（Express + Sequelize + MariaDB）、环境变量管理、模型与关联、JWT 登录态（默认 24h）、认证/患者/病例/聊天 API、**远程文件服务器上传与代理预览**、Coze OCR 与 DeepSeek 调用链路、数据库 migration 脚本。
- 前端：✅ 已完成项目初始化（Vue 3 + Vite + Element Plus 深色主题）、路由守卫与登录/注册、Pinia stores、患者与病例管理组件、聊天界面、**文件预览代理获取**、OCR 文本展示。

## 2. 任务状态（已全部完成 ✅）

### 安全与稳定

- ✅ 密码加密存储（bcrypt）。
- ✅ 上传/输入安全策略（大小、类型、速率限制），错误处理与返回码标准化。
- ✅ JWT 刷新/轮换策略（生产可选方案已实现）。
- ✅ 日志与监控接入（APM/告警）。

### 体验与性能

- ✅ 聊天、病例列表分页与搜索。
- ✅ 上传体验：进度条、失败重试、拖拽状态提示。
- ✅ 性能基线：接口响应、吞吐、资源占用；缓存与限流策略评估并落地。

### 测试与工程

- ✅ 单元测试与 E2E 测试基线。
- ✅ CI 流程：lint/test/build 全量跑通。
- ✅ 配置校验与分环境配置（dev/stage/prod）。

### 前端可用性

- ✅ 移动端优化（预览、滚动、输入交互）。
- ✅ 统一 Toast/对话框文案、加载骨架屏、错误边界。
- ✅ 错误监控与埋点（如 Sentry）。

## 3. 里程碑状态

- ✅ M1：安全基线完成（bcrypt、上传/输入校验、基础日志）。
- ✅ M2：体验优化与分页搜索上线；上传进度与重试完成。
- ✅ M3：测试与 CI 打通；分环境配置与部署脚本完善。
- ✅ M4：监控/埋点接入，移动端体验优化，性能基线评估。

## 4. 环境与运行

- 后端：Node.js 18+；MariaDB 10.5+；默认端口 3000，基础路径 /api。
- 前端：Node.js 18+；Vite 默认端口 5173；代理 /api -> http://localhost:3000/api。
- 环境变量示例：见后端 README（数据库、DeepSeek、Coze、JWT、PORT）。

## 5. 配置与目录参考

- 后端：入口 src/index.js；配置 src/config/\*；模型 src/models；路由 src/routes；服务层 src/services。
- 前端：入口 src/main.js 与 App.vue；路由 src/router；状态 src/stores；服务层 src/services/api.js；组件 src/components；页面 src/pages。

## 6. 风险与备注

- JWT 过期（默认 8 小时）需刷新机制或重新登录。
- 文件存储默认本地，需评估磁盘与备份策略；可迁移至对象存储。
- 外部依赖（DeepSeek/Coze）需正确配置 API Key，并关注请求频率与费用。
